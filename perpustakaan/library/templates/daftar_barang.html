<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Daftar Barang</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        base: '#f8fafc',
        panel: '#ffffff',
        soft: '#f1f5f9',
        borderSoft: '#e5e7eb',
        textMain: '#0f172a',
        textSoft: '#475569',
        accent: '#0ea5e9',
        accentSoft: '#38bdf8'
      },
      fontFamily: {
        poppins: ['Poppins', 'sans-serif']
      }
    }
  }
}
</script>
</head>

<body class="font-poppins min-h-screen bg-base text-textMain p-8">

<!-- ===== HEADER ===== -->
<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-10
            bg-panel border border-borderSoft rounded-2xl px-6 py-5 shadow-sm">

  <h2 class="text-xl font-semibold tracking-tight">Daftar Barang</h2>

  <div class="flex gap-3 items-center">
    <!-- SEARCH -->
    <input id="searchInput"
           type="text"
           placeholder="Cari barang..."
           class="px-4 py-2 rounded-xl bg-soft border border-borderSoft
                  text-sm outline-none
                  focus:ring-2 focus:ring-accent/30 transition w-56">

    <a href="/dashboard"
       class="px-5 py-2 rounded-xl bg-soft font-semibold text-sm
              hover:bg-white hover:-translate-y-0.5 transition">
      ‚Üê Dashboard
    </a>
  </div>
</div>

<!-- ===== LOADING SKELETON ===== -->
<div id="loading" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">
  {% for i in "1234" %}
  <div class="p-4 rounded-2xl bg-panel border border-borderSoft animate-pulse">
    <div class="h-32 bg-soft rounded-xl mb-4"></div>
    <div class="h-4 bg-soft rounded mb-2"></div>
    <div class="h-3 bg-soft rounded w-2/3"></div>
  </div>
  {% endfor %}
</div>

<!-- ===== GRID ===== -->
<div id="bukuContainer"
     class="hidden grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">

{% for b in barang %}
<div class="buku-card group flex gap-4 p-4 rounded-2xl bg-panel
            border border-borderSoft shadow-sm
            hover:shadow-lg hover:-translate-y-1
            transition duration-300">

  <!-- IMAGE -->
  <div class="w-[90px] h-[120px] flex-shrink-0 rounded-xl bg-soft p-2
              flex items-center justify-center
              group-hover:ring-2 group-hover:ring-accent/30 transition">
    {% if b.gambar %}
    <img src="{{ b.gambar.url }}"
         alt="{{ b.nama_barang }}"
         loading="lazy"
         class="w-full h-full object-contain opacity-0 transition-opacity duration-700">
    {% else %}
    <img src="https://images.unsplash.com/photo-1524995997946-a1c2e315a42f"
         loading="lazy"
         class="w-full h-full object-contain opacity-0 transition-opacity duration-700">
    {% endif %}
  </div>

  <!-- CONTENT -->
  <div class="flex flex-col flex-1">
    <h4 class="nama-buku text-sm font-semibold leading-tight
               group-hover:text-accent transition">
      {{ b.nama_barang }}
    </h4>

    <p class="text-xs text-textSoft mt-1">
      Kategori: {{ b.kategori.nama }}
    </p>

    <p class="text-xs font-semibold text-emerald-600 mt-2">
      Stok: {{ b.stok }}
    </p>

    <!-- ACTION -->
    <div class="mt-auto flex gap-2 pt-3">
      <a href="{% url 'library:pinjam' b.id %}"
         class="flex-1 text-center text-xs font-semibold py-2 rounded-lg
                bg-emerald-500 text-white
                hover:bg-emerald-400 transition">
        Pinjam
      </a>

      <a href="{% url 'library:ulasan' b.id %}"
         class="flex-1 text-center text-xs font-semibold py-2 rounded-lg
                bg-accent text-white
                hover:bg-accentSoft transition">
        Ulasan
      </a>
    </div>
  </div>
</div>
{% empty %}
<p class="text-textSoft">Tidak ada buku</p>
{% endfor %}

</div>

<!-- ===== SCRIPT (TIDAK DIUBAH) ===== -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  /* IMAGE FADE */
  document.querySelectorAll('img').forEach(img=>{
    if(img.complete) img.classList.remove('opacity-0');
    else img.addEventListener('load',()=>img.classList.remove('opacity-0'));
  });

  /* LOADING EFFECT */
  setTimeout(()=>{
    document.getElementById('loading').classList.add('hidden');
    document.getElementById('bukuContainer').classList.remove('hidden');
  }, 800);

  /* SEARCH */
  const searchInput = document.getElementById('searchInput');
  const cards = document.querySelectorAll('.buku-card');

  searchInput.addEventListener('input', ()=>{
    const value = searchInput.value.toLowerCase();
    cards.forEach(card=>{
      const nama = card.querySelector('.nama-buku').innerText.toLowerCase();
      card.style.display = nama.includes(value) ? 'flex' : 'none';
    });
  });

});
</script>

</body>
</html>
